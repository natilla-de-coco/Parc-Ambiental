<html>

<head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
</head>

<body>
    <a-scene cursor="rayOrigin: mouse">
        <a-assets>
            <!-- Imatges 360 -->
            <img id="ipresentacio" src="model360/assets/imatges/imatge0.jpg">
            <img id="ipresentacio2" src="model360/assets/imatges/0_general.jpg">
            <img id="i00" src="model360/assets/imatges/0_general.jpg">
            <img id="i01" src="model360/assets/imatges/1_1oficines.jpg">   
            <img id="i05" src="model360/assets/imatges/2_abocador.jpg">
            <img id="i07" src="model360/assets/imatges/3_plantatransferencia.jpg">    
            <img id="i06" src="model360/assets/imatges/4_motorbiogas.jpg">
            <img id="i08" src="model360/assets/imatges/5_bassesdaigues.jpg">
            <img id="i04" src="model360/assets/imatges/6_parcsolar.jpg">
            <img id="i09" src="model360/assets/imatges/7_plantacompostatge.jpg">
            <img id="i02" src="model360/assets/imatges/8_novaplanta.jpg">
            <img id="i03" src="model360/assets/imatges/9_falconeria.jpg">
            <img id="i010" mylink="https://fernando252778.github.io/XDDD/">            

            

            <!--imatge del plano-->
            <img id="dibuplano" src="model360/assets/imatges/parc_ambiental_mapa.jpg">

            <!--imatges de banderes-->
            <img id="bes" src="model360/assets/imatges/bes.png">
            <img id="bcat" src="model360/assets/imatges/bcat.png">
            <img id="buk" src="model360/assets/imatges/buk.png">

        </a-assets>

        <a-entity camera look-controls wasd-controls="false"></a-entity>
        <a-entity id="sound" sound></a-entity>

        <!-- Entorn 360 inicial -->
        <a-sky id="sky" src="#ipresentacio"></a-sky>
        <!-- Mostra les tres banderes -->
        <a-plane id="es" position="-1.5 -0.5 -2" src="#bes" rotation="0 0 0" scale="1 1 1" botocastella></a-plane>
        <a-plane id="cat" position="0 -0.5 -2" src="#bcat" rotation="0 0 0" scale="1 1 1" botocatala></a-plane>
        <a-plane id="uk" position="1.5 -0.5 -2" src="#buk" rotation="0 0 0" scale="1 1 1" botoangles></a-plane>

        <!-- Deixa el mapa a punt per mostrar a la propera-->
        <a-plane id="plano" position="0 -1 -2" src="#dibuplano" rotation="0 0 0" scale="2 1 2"
            visible="false"></a-plane>

        <!-- Punts d'interés a punt de mostrar-->

        <a-sphere id="esfera1" boto1="" position="0.08 -0.67 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera2" boto2="" position="0.4 -1 -1.793" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>
        
        <a-sphere id="esfera3" boto3="" position="0.17 -0.69 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera4" boto4="" position="-0.47 -1.14 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera5" boto5="" position="-0.50 -0.78 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>
        
        <a-sphere id="esfera6" boto6="" position="-0.72 -0.77 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera7" boto7="" position="-0.68 -0.85 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>
        
        <a-sphere id="esfera8" boto8="" position="-0.65 -0.95 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera9" boto9="" position="0.10 -1.30 -2" radius="0.027" color="green" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere> 
                 
        <a-sphere id="inici" inici="" position="0.97 -0.53 -2" radius="0.027" color="red" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>
        
        <a-plane id="plano" position="0 -1 -2" src="#dibuplano" rotation="0 0 0" scale="2 1 2" id="plano" position="0 -1 -2"
         src="#dibuplano" rotation="0 0 0" scale="2 1 2" visible="false" > </a-plane>




    </a-scene>


    <script>
        const sky = document.querySelector('#sky');
        const sound = document.querySelector('#sound');
        let idioma = "ca"
        const banderaEs = document.querySelector('#es');
        const banderaCat = document.querySelector('#cat');
        const banderaUk = document.querySelector('#uk');
        const esfera1 = document.querySelector('#esfera1');
        const esfera2 = document.querySelector('#esfera2');
        const esfera3 = document.querySelector('#esfera3');
        const esfera4 = document.querySelector('#esfera4');
        const esfera5 = document.querySelector('#esfera5');
        const esfera6 = document.querySelector('#esfera6');
        const esfera7 = document.querySelector('#esfera7');
        const esfera8 = document.querySelector('#esfera8');
        const esfera9 = document.querySelector('#esfera9');
        const inici = document.querySelector('#inici');
        const plano = document.querySelector('#plano');
        const mapa = document.querySelector('#plano');

        //elimina el moviment de les tecles del cursor
        document.querySelector("[camera]").removeAttribute("wasd-controls");

        //funció per sonar audio, va a buscar la carpeta de l'idioma
        function playAudio(nomFitxer) {
            const ruta = `model360/assets/audios/${idioma}/${nomFitxer}.mp3`;
            console.log('Reproduint:', ruta);
            if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                sound.components.sound.stopSound();
            }
            sound.setAttribute('sound', `src: url(${ruta})`);
            // Espera un moment perquè el component `sound` s'inicialitzi abans de reproduir
            setTimeout(() => {
                if (sound.components && sound.components.sound) {
                    sound.components.sound.playSound();
                }
            }, 100);
        }


        //si prem boto angles, carrega la imatge 00
        //deixa de mostrar les banderes, mostra el mapa
        //mostra els punts d'interes i sona la locució inicial en l'idioma que toca
        AFRAME.registerComponent("botoangles", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i00'); //Mostra la imatge 0  
                    banderaEs.setAttribute('visible', false);
                    banderaCat.setAttribute('visible', false);
                    banderaUk.setAttribute('visible', false);
                    esfera1.setAttribute('visible', true);
                    esfera2.setAttribute('visible', true);
                    esfera3.setAttribute('visible', true);
                    esfera4.setAttribute('visible', true);
                    esfera5.setAttribute('visible', true);
                    esfera6.setAttribute('visible', true);
                    esfera7.setAttribute('visible', true);
                    esfera8.setAttribute('visible', true); 
                    esfera9.setAttribute('visible', true); 
                    inici.setAttribute('visible', true);
                    plano.setAttribute('visible', true);
                    mapa.setAttribute('visible', true);
                    idioma = "uk"
                    playAudio("Abocador");  
                })
            }
        });

                AFRAME.registerComponent("casa", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i00'); //Mostra la imatge 0  
                    banderaEs.setAttribute('visible', false);
                    banderaCat.setAttribute('visible', false);
                    banderaUk.setAttribute('visible', false);
                    esfera1.setAttribute('visible', true);
                    esfera2.setAttribute('visible', true);
                    esfera3.setAttribute('visible', true);
                    esfera4.setAttribute('visible', true);
                    esfera5.setAttribute('visible', true);
                    esfera6.setAttribute('visible', true);
                    esfera7.setAttribute('visible', true);
                    esfera8.setAttribute('visible', true); 
                    esfera9.setAttribute('visible', true); 
                    inici.setAttribute('visible', true); 
                    plano.setAttribute('visible', true);
                    mapa.setAttribute('visible', true);
                    idioma = "uk"
                    playAudio("Abocador");  
                })
            }
        });

        AFRAME.registerComponent("botocatala", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i00'); //Mostra la imatge 0  
                    banderaEs.setAttribute('visible', false);
                    banderaCat.setAttribute('visible', false);
                    banderaUk.setAttribute('visible', false);
                    esfera1.setAttribute('visible', true);
                    esfera2.setAttribute('visible', true);
                    esfera3.setAttribute('visible', true);
                    esfera4.setAttribute('visible', true);
                    esfera5.setAttribute('visible', true);
                    esfera6.setAttribute('visible', true);
                    esfera7.setAttribute('visible', true);
                    esfera8.setAttribute('visible', true);
                    esfera9.setAttribute('visible', true);
                    inici.setAttribute('visible', true); 
                    mapa.setAttribute('visible', true);
                    idioma = "cat"
                    playAudio("Abocador");
                })
            }
        });

        AFRAME.registerComponent("botocastella", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i00'); //Mostra la imatge 0  
                    banderaEs.setAttribute('visible', false);
                    banderaCat.setAttribute('visible', false);
                    banderaUk.setAttribute('visible', false);
                    esfera1.setAttribute('visible', true);
                    esfera2.setAttribute('visible', true);
                    esfera3.setAttribute('visible', true);
                    esfera4.setAttribute('visible', true);
                    esfera5.setAttribute('visible', true);
                    esfera6.setAttribute('visible', true);
                    esfera7.setAttribute('visible', true);
                    esfera8.setAttribute('visible', true);
                    esfera9.setAttribute('visible', true);
                    inici.setAttribute('visible', true); 
                    mapa.setAttribute('visible', true);
                    idioma = "es"
                    playAudio("Abocador");
                })
            }
        });

        AFRAME.registerComponent("boto1", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i01'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Oficines");
                })
            }
        });
        AFRAME.registerComponent("boto2", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i02'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Nova-planta-de-valorització");
                })
            }
        });

        AFRAME.registerComponent("boto3", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i03'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Falconeria");
                })
            }
        });  

        AFRAME.registerComponent("boto4", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i04'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Parc-solar");
                })
            }
        });      
        AFRAME.registerComponent("boto5", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i05'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Abocador");
                })
            }
        });
        AFRAME.registerComponent("boto6", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i06'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Motor-de-biogàs");
                })
            }
        });  
        AFRAME.registerComponent("boto7", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i07'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Planta-de-transferència-de-vidre-i-envasos");
                })
            }
        });     
        AFRAME.registerComponent("boto8", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i08'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Basses-d’aigües-pluvials");
                })
            }
        });        
        AFRAME.registerComponent("boto9", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i09'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Planta-de-compostatge");
                })
            }
        }); 
              
        AFRAME.registerComponent("plano", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i010'); //Mostra la imatge de la torre                
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Parc-ambiental");
                })
            }
        });       
        AFRAME.registerComponent("inici", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#ipresentacio'); //Mostra la imatge inicial
                    banderaEs.setAttribute('visible', true);
                    banderaCat.setAttribute('visible', true);
                    banderaUk.setAttribute('visible', true);
                    esfera1.setAttribute('visible', false);
                    esfera2.setAttribute('visible', false);
                    esfera3.setAttribute('visible', false);
                    esfera4.setAttribute('visible', false);
                    esfera5.setAttribute('visible', false);
                    esfera6.setAttribute('visible', false);
                    esfera7.setAttribute('visible', false);
                    esfera8.setAttribute('visible', false);
                    esfera9.setAttribute('visible', false);
                    inici.setAttribute('visible', false);
                    plano.setAttribute('visible', false);
                    mapa.setAttribute('visible', false);
                    if (sound.components && sound.components.sound && sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                })
            }
        });
        
        

    </script>
</body>

</html>
